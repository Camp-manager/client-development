<div class="container-campistas card full-page-card">
  <div class="card-header">
    <h3 class="card-title">
      Lista de Campistas @if (acampamento) {
      <small class="text-muted"
        >- {{ acampamento.tipoAcampamento.descricao }} ({{
          acampamento.codigoRegistro
        }})</small
      >
      }
    </h3>
  </div>

  <div class="card-body">
    @if (isLoading) {
    <p class="loading-state">Carregando campistas...</p>
    } @else if (error) {
    <p class="error-state">{{ error }}</p>
    } @else if (campistas.length > 0 && acampamento) {
    <div class="table-responsive-wrapper">
      <table class="app-table">
        <thead>
          <tr>
            <th>Nome Completo</th>
            <th>Idade</th>
            <th>Contato</th>
            <th>Alérgico(a)</th>
            <th>Medicamentos</th>
            <th>Já Acampou?</th>
          </tr>
        </thead>
        <tbody>
          @for (campista of campistas; track campista.id) {
          <tr>
            <td>{{ campista.pessoa.nomeCompleto }}</td>
            <td>{{ calcularIdade(campista.pessoa.dataNascimento) }} anos</td>
            <td>{{ campista.pessoa.telefone || "-" }}</td>
            <td>
              @if(campista.isAlergico === 'S') {
              <span title="{{ campista.alergias }}"
                ><i class="fas fa-allergies icon-sm"></i> Sim</span
              >
              } @else {
              <span>Não</span>
              }
            </td>
            <td>
              @if(campista.usaMedicamento === 'S') { @if(campista.medicamentos
              && campista.medicamentos.length > 0) {
              <ul>
                @for(med of campista.medicamentos; track med.id) {
                <li title="{{ med.quantidade }} ({{ med.tipo }})">
                  <i class="fas fa-pills icon-sm"></i> {{ med.nome }}
                </li>
                }
              </ul>
              } @else {
              <span
                ><i class="fas fa-pills icon-sm"></i> Sim (detalhes não
                fornecidos)</span
              >
              } } @else {
              <span>Não</span>
              }
            </td>
            <td>
              {{ campista.jaAcampou === "S" ? "Sim" : "Não" }}
              @if(campista.jaAcampou === 'S' && campista.acampamentosJaFeitos) {
              <small class="text-muted d-block"
                >({{ campista.acampamentosJaFeitos }})</small
              >
              }
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
    } @else if (acampamento) {
    <p class="empty-state">
      Nenhum campista encontrado para o acampamento "{{
        acampamento.nomeAcampamento
      }}" ({{ acampamento.codigoRegistro }}).
    </p>
    } @else {
    <p class="select-camp-state">
      Nenhum acampamento selecionado ou encontrado.
    </p>
    }
  </div>

  <div class="card-footer">
    <button
      type="button"
      class="btn btn-secondary"
      routerLink="/acampamentos/lista"
    >
      <i class="fas fa-arrow-left"></i> Voltar para Acampamentos
    </button>
  </div>
</div>
